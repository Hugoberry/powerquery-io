---
title: BinaryFormat.Group
---

# BinaryFormat.Group


## Description

Повертає двійковий формат, який читає групу елементів.


## Syntax

```powerquery
BinaryFormat.Group(
    binaryFormat as function,
    group as list,
    optional extra as function,
    optional lastKey as any
) as function
```


## Details

Використовуються вказані нижче параметри.<ul><li>Параметр <code>binaryFormat</code> указує двійковий формат значення ключа.</li><li>Параметр <code>group</code> надає інформацію про групу відомих елементів.</li><li>За допомогою додаткового параметра <code>extra</code> можна вказати функцію, яка повертатиме значення двійкового формату для неочікуваного значення після ключа. Якщо параметр <code>extra</code> не вказано, неочікувані значення ключів викликатимуть помилку.</li></ul>Параметр <code>group</code> указує список визначень елементів. Кожне визначення елемента – це список із 3–5 значень, які описано нижче.<ul><li>Значення ключа. Значення ключа, яке відповідає елементу. Воно має бути унікальне в межах набору елементів.</li><li>Формат елемента. Двійковий формат, який відповідає значенню елемента. Завдяки цьому параметру кожен елемент може мати власний формат. </li><li>Екземпляри елемента. Значення <code>BinaryOccurrence.Type</code> указує, скільки екземплярів елемента очікується в групі. Якщо бракує обов’язкових елементів, викликається помилка. Повтори обов’язкових або необов’язкових елементів обробляються як неочікувані значення ключів.</li><li>Стандартне значення елемента (додатково). Якщо в списку визначень елементів є стандартне значення елемента, яке відрізняється від Null, воно використовуватиметься замість стандартного значення. Стандартне значення для повторюваних або необов’язкових елементів становить Null, а для повторюваних значень – пустий список \{ }.</li><li>Перетворення значення елемента (додатково). Якщо в списку визначень елементів є функція перетворення значення елемента, яка відрізняється від Null-значення, вона перетворюватиме значення елемента перед його поверненням. Функція перетворення викликається тільки тоді, коли елемент зустрічається у вводі (ніколи не викликається зі стандартним значенням). </li></ul>


## Examples

### Example #1 
У наведеному нижче прикладі припускається, що значення ключа є однобайтним із 4 очікуваними елементуми у групі, у всіх із яких після ключа є байт даних.  Елементи з&#39;являються у вхідних параметрах у наведений нижче спосіб.&lt;ul&gt;&lt;li&gt;Ключ 1 – обов&#39;язковий, і він не з&#39;являється зі значенням 11.&lt;/li&gt;&lt;li&gt;Ключ 2 повторюється й з&#39;являться двічі зі значенням 22 та призводить до значення \{ 22, 22 }.&lt;/li&gt;&lt;li&gt;Ключ 3 – необов&#39;язковий, не з&#39;являться та призводить до Null-значення.&lt;/li&gt;&lt;li&gt;Ключ 4 повторюється, але не з&#39;являться, і призводить до значення \{ }.&lt;/li&gt;&lt;li&gt;Ключ 5 не є частиною групи, але з&#39;являється один раз зі значенням 55.  Викликається додаткова функція зі значенням ключа 5, яка повертає формат, що відповідає такому значенню (BinaryFormat.Byte).  Значення 55 читається та скасовується.&lt;/li&gt;&lt;/ul&gt;
```powerquery
let
    b = #binary({
        1, 11,
        2, 22,
        2, 22,
        5, 55,
        1, 11
    }),
    f = BinaryFormat.Group(
        BinaryFormat.Byte,
        {
            {1, BinaryFormat.Byte, BinaryOccurrence.Required},
            {2, BinaryFormat.Byte, BinaryOccurrence.Repeating},
            {3, BinaryFormat.Byte, BinaryOccurrence.Optional},
            {4, BinaryFormat.Byte, BinaryOccurrence.Repeating}
        },
        (extra) => BinaryFormat.Byte
    )
in
    f(b)
```

Result: 
```powerquery
{11, {22, 22}, null, {}}
```


### Example #2 
У наведеному далі прикладі показано перетворення значення елементу та значення елементу за замовчуванням.   Повторюваний елемент із ключем 1 сумує список значень, прочитаних за допомогою List.Sum.  Необов&#39;язковий елемент із ключем 2 має значення за замовчуванням 123 замість Null.
```powerquery
let
    b = #binary({
        1, 101,
        1, 102
    }),
    f = BinaryFormat.Group(
        BinaryFormat.Byte,
        {
            {1, BinaryFormat.Byte, BinaryOccurrence.Repeating,
              0, (list) => List.Sum(list)},
            {2, BinaryFormat.Byte, BinaryOccurrence.Optional, 123}
        }
    )
in
    f(b)
```

Result: 
```powerquery
{203, 123}
```




## Category
Binary Formats.Reading a group of items
